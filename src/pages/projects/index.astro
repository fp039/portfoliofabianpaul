---
import Layout from '../../layouts/Layout.astro';
import Navigation from '../../components/Navigation.vue';
import Footer from '../../components/Footer.astro';

const projects = [
  {
    title: "Wontec",
    description: "Branding & Webdesign für einen Visionär im Projektmanagement",
    image: "/images/website-wontec-2000x1125.png",
    link: "/projects/wontec",
    tags: ["Branding", "Webdesign", "Development", "UI/UX Design"],
    featured: true
  },
  {
    title: "Brennerei Fischer",
    description: "Gin & Branding: Tradition in dritter Generation, neu interpretiert",
    image: "/images/gin-fischer-1920x1080.jpg",
    link: "/projects/fischer",
    tags: ["Branding", "Packaging Design", "Corporate Design", "Etiketten Design"],
    featured: false
  },
  {
    title: "Steillagen",
    description: "Ein Etikett, das die Geschichte der Steillagen erzählt",
    image: "/images/rose-steillagen-2000x1125.jpg",
    link: "/projects/steillagen",
    tags: ["Branding", "Etiketten Design", "Packaging"],
    featured: false
  }
];
---

<Layout title="Projekte - Fabian Paul">
  <Navigation client:load />
  
  <main class="bg-[#1E1E1E] min-h-screen">
    <!-- Header -->
    <div class="pt-32 pb-16 px-8">
      <div class="max-w-[1800px] mx-auto">
        <div class="max-w-4xl flex flex-col gap-[clamp(16px,2.5vw,24px)]">
          <span class="text-[#0F0] text-sm uppercase tracking-wider font-light">
            ALL NEW
          </span>  
          <div class="flex flex-col gap-[clamp(8px,1.5vw,12px)]">
            <h1 class="text-[clamp(2.5rem,8vw,5rem)] font-medium leading-[0.9] tracking-tight pb-4">
              Projects
            </h1>
                <!-- Filter Section -->
    <div>
      <div class="max-w-[1800px] mx-auto">
        <div class="flex flex-wrap gap-[clamp(8px,1vw,10px)]">
          <button 
            class="px-5 py-2.5 rounded-full border-2 border-[#E5E5E5]/20 text-[#E5E5E5]/80 text-sm uppercase tracking-wide hover:border-[#E5E5E5]/40 hover:text-[#E5E5E5] transition-all duration-300 filter-btn active"
            data-filter="all"
          >
            Alle
          </button>
          <button 
            class="px-5 py-2.5 rounded-full border-2 border-[#E5E5E5]/20 text-[#E5E5E5]/80 text-sm uppercase tracking-wide hover:border-[#E5E5E5]/40 hover:text-[#E5E5E5] transition-all duration-300 filter-btn"
            data-filter="auswahl"
          >
            Auswahl
          </button>
          <button 
            class="px-5 py-2.5 rounded-full border-2 border-[#E5E5E5]/20 text-[#E5E5E5]/80 text-sm uppercase tracking-wide hover:border-[#E5E5E5]/40 hover:text-[#E5E5E5] transition-all duration-300 filter-btn"
            data-filter="branding"
          >
            Branding
          </button>
          <button 
            class="px-5 py-2.5 rounded-full border-2 border-[#E5E5E5]/20 text-[#E5E5E5]/80 text-sm uppercase tracking-wide hover:border-[#E5E5E5]/40 hover:text-[#E5E5E5] transition-all duration-300 filter-btn"
            data-filter="webdesign"
          >
            Webdesign
          </button>
          <button 
            class="px-5 py-2.5 rounded-full border-2 border-[#E5E5E5]/20 text-[#E5E5E5]/80 text-sm uppercase tracking-wide hover:border-[#E5E5E5]/40 hover:text-[#E5E5E5] transition-all duration-300 filter-btn"
            data-filter="packaging"
          >
            Packaging
          </button>
        </div>
      </div>
    </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Projects Container -->
    <div class="px-4 md:px-8 pb-[clamp(48px,10vw,128px)]">
      <div class="max-w-[1800px] mx-auto">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-[clamp(24px,5vw,96px)]">
          <!-- Wontec -->
          <div class="md:col-span-2 space-y-[clamp(16px,3vw,32px)] project-item" data-categories="auswahl,branding,webdesign,development">
            <a href="/projects/wontec" class="block group">
              <div class="aspect-[16/9] overflow-hidden relative" data-speed="0.01">
                <img 
                  src="/images/website-wontec-2000x1125.png"
                  alt="Wontec"
                  class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105"
                />
              </div>
            </a>
            <div class="flex flex-col gap-[clamp(4px,1vw,8px)]">
              <div class="flex flex-col gap-[clamp(8px,1.5vw,12px)]">
                <h2 class="text-[24px] md:text-[32px] font-medium leading-[0.9] tracking-tight">
                  Wontec
                </h2>
                <p class="text-sm md:text-base font-light italic max-w-2xl text-[#E5E5E5]/90">
                  Branding & Webdesign für einen Visionär im Projektmanagement
                </p>
              </div>
              <div class="flex flex-wrap gap-[clamp(6px,1vw,12px)]">
                {projects[0].tags.map(tag => (
                  <span class="px-[clamp(12px,2vw,16px)] py-[clamp(6px,1vw,8px)] rounded-full border border-[#E5E5E5]/20 text-[#E5E5E5]/60 text-[clamp(12px,1vw,14px)]">
                    {tag}
                  </span>
                ))}
              </div>
            </div>
          </div>

          <!-- Steillagen -->
          <div class="space-y-[clamp(16px,3vw,32px)] project-item" data-categories="branding,packaging">
            <a href="/projects/steillagen" class="block group">
              <div class="aspect-[16/9] overflow-hidden relative" data-speed="-0.01">
                <img 
                  src="/images/rose-steillagen-2000x1125.jpg"
                  alt="Steillagen"
                  class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105"
                />
              </div>
            </a>
            <div class="flex flex-col gap-[clamp(8px,1.5vw,12px)]">
              <div class="flex flex-col gap-[clamp(8px,1.5vw,12px)]">
                <h2 class="text-[24px] md:text-[32px] font-medium leading-[0.9] tracking-tight">
                  Steillagen
                </h2>
                <p class="text-sm md:text-base font-light italic max-w-2xl text-[#E5E5E5]/90">
                  Ein Etikett, das die Geschichte der Steillagen erzählt
                </p>
              </div>
              <div class="flex flex-wrap gap-[clamp(6px,1vw,12px)]">
                {projects[2].tags.map(tag => (
                  <span class="px-[clamp(12px,2vw,16px)] py-[clamp(6px,1vw,8px)] rounded-full border border-[#E5E5E5]/20 text-[#E5E5E5]/60 text-[clamp(12px,1vw,14px)]">
                    {tag}
                  </span>
                ))}
              </div>
            </div>
          </div>

          <!-- Fischer -->
          <div class="md:col-span-2 space-y-[clamp(16px,3vw,32px)] project-item" data-categories="branding,packaging">
            <a href="/projects/fischer" class="block group">
              <div class="aspect-[16/9] overflow-hidden md:mr-48" data-speed="0.03">
                <img 
                  src="/images/gin-fischer-1920x1080.jpg"
                  alt="Fischer"
                  class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105"
                />
              </div>
            </a>
            <div class="flex flex-col gap-[clamp(8px,1.5vw,12px)]">
              <div class="flex flex-col gap-[clamp(8px,1.5vw,12px)]">
                <h2 class="text-[24px] md:text-[32px] font-medium leading-[0.9] tracking-tight">
                  Brennerei Fischer
                </h2>
                <p class="text-sm md:text-base font-light italic max-w-2xl text-[#E5E5E5]/90">
                  Gin & Branding: Tradition in dritter Generation, neu interpretiert
                </p>
              </div>
              <div class="flex flex-wrap gap-[clamp(6px,1vw,12px)]">
                {projects[1].tags.map(tag => (
                  <span class="px-[clamp(12px,2vw,16px)] py-[clamp(6px,1vw,8px)] rounded-full border border-[#E5E5E5]/20 text-[#E5E5E5]/60 text-[clamp(12px,1vw,14px)]">
                    {tag}
                  </span>
                ))}
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <Footer />
</Layout>

<script>
  // Parallax Effect
  const initParallax = () => {
    const parallaxElements = document.querySelectorAll('[data-speed]');
    
    window.addEventListener('scroll', () => {
      parallaxElements.forEach(element => {
        const speed = parseFloat(element.getAttribute('data-speed'));
        const rect = element.getBoundingClientRect();
        const scrolled = window.pageYOffset;
        
        const yPos = -(scrolled * speed);
        
        // Limit the parallax effect
        const maxOffset = 50; // Maximum pixel offset
        const limitedYPos = Math.max(Math.min(yPos, maxOffset), -maxOffset);
        
        if (rect.top < window.innerHeight && rect.bottom > 0) {
          gsap.to(element, {
            y: limitedYPos,
            duration: 0.5,
            ease: 'none'
          });
        }
      });
    });
  };

  window.addEventListener('load', () => {
    if (typeof gsap === 'undefined') return;
    initParallax();
  });
</script>

<script>
  const initFilter = () => {
    const filterBtns = document.querySelectorAll('.filter-btn');
    const projects = document.querySelectorAll('.project-item');
    // Initialisiere mit allen Projekten als sichtbar
    let currentlyVisible = new Set(projects);

    filterBtns.forEach(btn => {
      btn.addEventListener('click', () => {
        filterBtns.forEach(b => b.classList.remove('active'));
        btn.classList.add('active');

        const filterValue = btn.getAttribute('data-filter');
        let newlyVisible = new Set();
        let toHide = new Set();
        let toShow = new Set();

        // Wenn "Alle" geklickt wird, spezielle Behandlung
        if (filterValue === 'all') {
          projects.forEach(project => {
            project.style.display = 'block';
          });
          
          gsap.fromTo(projects,
            {
              opacity: 0,
              y: 30,
              scale: 0.95
            },
            {
              opacity: 1,
              y: 0,
              scale: 1,
              duration: 0.8,
              ease: 'power2.out',
              stagger: {
                amount: 0.3,
                from: "start"
              },
              clearProps: "all"
            }
          );
          
          currentlyVisible = new Set(projects);
          return;
        }

        projects.forEach(project => {
          const categories = project.getAttribute('data-categories').split(',');
          const shouldBeVisible = filterValue === 'all' || categories.includes(filterValue);
          
          if (shouldBeVisible) {
            newlyVisible.add(project);
            // Wenn es vorher nicht sichtbar war, muss es eingeblendet werden
            if (!currentlyVisible.has(project)) {
              toShow.add(project);
            }
          } else if (currentlyVisible.has(project)) {
            // Wenn es vorher sichtbar war, muss es ausgeblendet werden
            toHide.add(project);
          }
        });

        // Nur die Elemente ausblenden, die wirklich versteckt werden müssen
        if (toHide.size > 0) {
          gsap.to(Array.from(toHide), {
            opacity: 0,
            y: 30,
            scale: 0.95,
            duration: 0.5,
            ease: 'power2.inOut',
            stagger: {
              amount: 0.2,
              from: "random"
            },
            onComplete: () => {
              toHide.forEach(project => {
                project.style.display = 'none';
              });
              
              // Nur neue Elemente einblenden
              if (toShow.size > 0) {
                Array.from(toShow).forEach(project => {
                  project.style.display = 'block';
                });
              
                gsap.fromTo(Array.from(toShow),
                  {
                    opacity: 0,
                    y: 50,
                    scale: 0.95
                  },
                  {
                    opacity: 1,
                    y: 0,
                    scale: 1,
                    duration: 0.8,
                    ease: 'power2.out',
                    stagger: {
                      amount: 0.3,
                      from: "start"
                    },
                    clearProps: "all"
                  }
                );
              }
            }
          });
        } else if (toShow.size > 0) {
          // Wenn nichts ausgeblendet werden muss, aber neue Elemente angezeigt werden sollen
          Array.from(toShow).forEach(project => {
            project.style.display = 'block';
          });
          
          gsap.fromTo(Array.from(toShow),
            {
              opacity: 0,
              y: 50,
              scale: 0.95
            },
            {
              opacity: 1,
              y: 0,
              scale: 1,
              duration: 0.8,
              ease: 'power2.out',
              stagger: {
                amount: 0.3,
                from: "start"
              },
              clearProps: "all"
            }
          );
        }

        // Update currently visible projects
        currentlyVisible = newlyVisible;
      });
    });
  };

  window.addEventListener('load', initFilter);
</script>

<style>
  .filter-btn.active {
    @apply border-[#0F0] text-[#0F0];
  }

  .project-item {
    will-change: transform, opacity;
  }
</style> 