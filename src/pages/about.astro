---
import Layout from '../layouts/Layout.astro';
import Navigation from '../components/Navigation.vue';
import Footer from '../components/Footer.astro';
import TechCard from '../components/TechCard.vue';
import RotatingCircle from '../components/ui/RotatingCircle.astro';
import '../utils/gsapInit';
import { getAssetPath } from '../utils/paths';
import { Image } from 'astro:assets';
import portraitImage from '../assets/images/shared/portrait-fabian-1683x1920.jpg';
import portraitWithDog from '../assets/images/shared/fabian-mit-hund.jpg';
import astroIcon from '../assets/icons/astro.svg';
import vueIcon from '../assets/icons/vue.svg';
import tailwindIcon from '../assets/icons/tailwind.svg';
import gsapIcon from '../assets/icons/gsap.svg';
import figmaIcon from '../assets/icons/figma.svg';
import adobeIcon from '../assets/icons/adobe.svg';

// Berechne Alter
const birthDate = new Date('1995-10-06');
const today = new Date();
const age = Math.floor((today.getTime() - birthDate.getTime()) / (365.25 * 24 * 60 * 60 * 1000));

// Berechne Erfahrung seit Ausbildungsbeginn
const careerStart = new Date('2015-09-01');
const yearsExperience = Math.floor((today.getTime() - careerStart.getTime()) / (365.25 * 24 * 60 * 60 * 1000));

const techStack = [
  {
    name: 'Astro',
    category: 'Frontend',
    description: 'Schnelle statische Websites mit optimaler Performance',
    icon: astroIcon
  },
  {
    name: 'Vue.js',
    category: 'Frontend',
    description: 'Moderne, reaktive Benutzeroberflächen mit hoher Interaktivität',
    icon: vueIcon
  },
  {
    name: 'Tailwind',
    category: 'Frontend',
    description: 'Utility-First CSS für schnelles, konsistentes Design',
    icon: tailwindIcon
  },
  {
    name: 'GSAP',
    category: 'Animation',
    description: 'Professionelle Webanimationen für lebendige Interfaces',
    icon: gsapIcon
  },
  {
    name: 'Figma',
    category: 'Design',
    description: 'UI/UX Design & Prototyping für Nutzererlebnisse',
    icon: figmaIcon
  },
  {
    name: 'Adobe CC',
    category: 'Design',
    description: 'Kreative Designlösungen von Branding bis Print',
    icon: adobeIcon
  }
];

---

<Layout title="About - Fabian Paul">
  <Navigation client:load />
  
  <main class="bg-background min-h-screen" id="main-content">
    <!-- Hero Section -->
    <section class="pt-48 pb-16">
      <div class="container mx-auto px-8">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-16 items-start">
          <!-- Image Gallery -->
          <div class="relative w-full max-w-[600px] lg:max-w-none mx-auto">
            <div class="aspect-square lg:aspect-[7/9] overflow-hidden group relative animate-image">
              <Image 
                src={portraitImage}
                alt="Portrait von Fabian Paul"
                class="w-full h-full object-cover"
                width={800}
                height={1024}
                loading="eager"
                fetchpriority="high"
                format="webp"
                quality={90}
              />
              <Image 
                src={portraitWithDog}
                alt="Fabian mit seinem Hund Mira"
                class="w-full h-full object-cover absolute inset-0 opacity-0"
                width={800}
                height={1024}
                loading="lazy"
                format="webp"
                quality={90}
              />
            </div>
          </div>

          <!-- Bio Content -->
          <div class="space-y-8 hero-content">
            <div class="flex items-center justify-between">
              <div>
                <h1 class="text-fluid-3xl font-medium text-text-primary mb-2">Hi, ich bin Fabian</h1>
                <p class="text-fluid-base text-text-secondary">Designer & Creative Developer</p>
              </div>
              <div class="relative">
                <RotatingCircle class="ml-4" />
              </div>
            </div>

            <div class="space-y-4 text-fluid-base text-text-secondary">
              <p>
                Ich bin {age} Jahre alt und verbinde meine fundierte Ausbildung 
                als Mediengestalter Digital und Print mit meiner Leidenschaft für ästhetisches Design 
                und technische Innovation.
              </p>
              <p>
                In den letzten {yearsExperience} Jahren habe ich sowohl in verschiedenen Agenturen 
                als auch in der Automobilbranche und deren Zulieferunternehmen meine detailverliebte 
                und ergebnisorientierte Arbeitsweise weiterentwickelt. Aktuell beende ich mein Medieninformatik-Studium, 
                wo ich meine Fähigkeiten im Frontend- und Backend-Bereich weiter vertiefe.
              </p>
              <p>
                Mein Herz schlägt besonders für UI/UX-Design und Frontend-Entwicklung. Ich liebe es, 
                digitale Erlebnisse zu schaffen, die nicht von der Stange kommen, sondern maßgeschneidert 
                beeindrucken. Qualität steht für mich immer vor Quantität – jedes Projekt verdient 100% 
                Einsatz.
              </p>
            </div>

            <!-- Quick Stats -->
            <div class="grid grid-cols-2 gap-8 pt-6">
              <div class="space-y-1">
                <span class="text-accent text-fluid-sm">Erfahrung</span>
                <p class="text-fluid-lg font-medium text-text-primary">{yearsExperience}+ Jahre</p>
              </div>
              <div class="space-y-1">
                <span class="text-accent text-fluid-sm">Spezialisierung</span>
                <p class="text-fluid-lg font-medium text-text-primary">UI/UX & Frontend</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Tech Stack Section -->
    <section class="py-24 bg-background-secondary/20">
      <div class="container mx-auto px-8">
        <div class="max-w-4xl mx-auto space-y-12 tech-stack">
          <div>
            <h2 class="text-fluid-2xl font-medium text-text-primary mb-3">Tech Stack & Tools</h2>
            <p class="text-fluid-base text-text-secondary">
              Als leidenschaftlicher Designer und Entwickler setze ich auf moderne Technologien, 
              die es mir ermöglichen, beeindruckende und maßgeschneiderte digitale Erlebnisse zu schaffen. 
              Mein Fokus liegt dabei immer auf der perfekten Balance zwischen Ästhetik und Funktionalität.
            </p>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            {techStack.map((tech) => (
              <div class="h-full">
                <TechCard 
                  client:visible 
                  name={tech.name} 
                  category={tech.category} 
                  description={tech.description}
                  icon={tech.icon}
                  class="h-full"
                />
              </div>
            ))}
          </div>
        </div>
      </div>
    </section>
  </main>

  <Footer />
</Layout>

<script>
// Initialisiere die Animationen
const initAboutAnimations = () => {
  console.log('initAboutAnimations wurde aufgerufen');

  if (typeof window.gsap === 'undefined') {
    console.warn('GSAP ist nicht geladen');
    return;
  }

  console.log('GSAP ist geladen');

  // Stelle sicher, dass ScrollTrigger registriert ist
  window.gsap.registerPlugin(ScrollTrigger);
  console.log('ScrollTrigger wurde registriert');

  // Hero Content Animation
  const mainTimeline = window.gsap.timeline({
    scrollTrigger: {
      trigger: "#main-content",
      start: "top center",
      end: "bottom center",
      once: true,
      onEnter: () => console.log('mainTimeline wurde getriggert')
    }
  });

  // Hero Content Animation
  mainTimeline
    .from(".animate-image", {
      opacity: 0,
      y: 50,
      duration: 0.8
    })
    .from(".hero-content h1", {
      opacity: 0,
      y: 30,
      duration: 0.6
    }, "-=0.3")
    .from(".hero-content .text-fluid-base", {
      opacity: 0,
      y: 30,
      duration: 0.6
    }, "-=0.3")
    .from(".hero-content .space-y-4 p", {
      opacity: 0,
      y: 30,
      stagger: 0.2,
      duration: 0.6
    }, "-=0.3")
    .from(".hero-content .space-y-3", {
      opacity: 0,
      y: 30,
      duration: 0.6
    }, "-=0.3")
    .from(".hero-content .grid.grid-cols-2", {
      opacity: 0,
      y: 30,
      duration: 0.6
    }, "-=0.3");

  // Tech Stack Animation
  const techTimeline = window.gsap.timeline({
    scrollTrigger: {
      trigger: ".tech-stack",
      start: "top center",
      end: "bottom center",
      once: true
    }
  });

  techTimeline
    .from(".tech-stack h2", {
      opacity: 0,
      y: 30,
      duration: 0.6
    })
    .from(".tech-stack p", {
      opacity: 0,
      y: 30,
      duration: 0.6
    }, "-=0.3")
    .from("div[data-tech-card]", {
      opacity: 0,
      y: 30,
      duration: 0.6,
      stagger: 0.15,
      ease: "power2.out"
    }, "-=0.3");

  // Bild Hover Effect
  const imageContainer = document.querySelector('.animate-image');
  if (imageContainer) {
    const mainImage = imageContainer.querySelector('img:first-child');
    const secondImage = imageContainer.querySelector('img:last-child');

    imageContainer.addEventListener('mouseenter', () => {
      window.gsap.to([mainImage, secondImage], {
        scale: 1.05,
        opacity: (i) => i === 1 ? 1 : 1,
        duration: 0.5,
        ease: "power2.out"
      });
    });

    imageContainer.addEventListener('mouseleave', () => {
      window.gsap.to([mainImage, secondImage], {
        scale: 1,
        opacity: (i) => i === 1 ? 0 : 1,
        duration: 0.5,
        ease: "power2.out"
      });
    });
  }
};

// Initialize animations
console.log('Script wird geladen');
window.addEventListener('load', () => {
  console.log('Window load event wurde ausgelöst');
  initAboutAnimations();
});
document.addEventListener('astro:page-load', () => {
  console.log('Astro page load event wurde ausgelöst');
  initAboutAnimations();
});
</script> 